---
layout: post
date: 2014-12-28  1:17:58 +0800
title: http协议相关知识整理
tag: http
---


##连接

在HTTP 客户端向服务器发送报文之前，需要用网际协议（Internet Protocol，IP） 地址和端口号在客户端和服务器之间建立一条TCP/IP 连接。
HTTP 连接实际上就是TCP 连接及其使用规则。TCP 连接是因特网上的可靠连接。TCP 为HTTP 提供了一条可靠的比特传输管道。从TCP 连接一端填入的字节会从另一端以原有的顺序、正确地传送出来。

浏览器访问服务器的过程：

1. 浏览器解析出主机名
2. 浏览器查询这个主机名的IP地址（DNS）
3. 浏览器获得端口号（80）
4. 浏览器发起到 x.x.x.x 端口 xx 的连接
5. 浏览器向服务器发送一条HTTP GET报文
6. 浏览器从服务器读取HTTP响应报文

HTTP 事务的时延有以下几种主要原因:
1. 客户端首先需要根据URI 确定Web 服务器的IP 地址和端口号。如果最近没有对 URI 中的主机名进行访问，通过DNS 解析系统将URI 中的主机名转换成一个IP 地址可能要花费数十秒的时间。
2. 接下来，客户端会向服务器发送一条TCP 连接请求，并等待服务器回送一个请 求接受应答。每条新的TCP 连接都会有连接建立时延。这个值通常最多只有一 两秒钟，但如果有数百个HTTP 事务的话，这个值会快速地叠加上去。
3. 一旦连接建立起来了，客户端就会通过新建立的TCP 管道来发送HTTP 请求。 数据到达时，Web 服务器会从TCP 连接中读取请求报文，并对请求进行处理

大多数HTTP 客户端都有一个小的DNS 缓存，用来保存近期所访问站点的IP 地址。如果 已经在本地“缓存”（记录）了IP 地址，查询就可以立即完成。因为大多数Web 浏览器浏览的都是少数常用站点，所以通常都可以很快地将主机名解析出来。




